http://www.linuxfoundation.org/collaborate/workgroups/networking/netem

Install:
nothing; the program name is tc and is part of the core linux utilities

Setup:
add:

alias sudo='sudo env PATH=$PATH'

to ~/.bashrc
This is because we'll need to run a script with sudo, but ubuntu is stupid and does not preserve $PATH in sudo commands, as specified in the sudo man page.

Add this script in your $PATH (mine is ~/Programming/system/)

#!/bin/bash
tc qdisc add dev lo root netem delay 0ms
tc qdisc change dev lo root netem delay ${1}ms

save it as set_latency (or whatever)

use it like:

sudo set_latency 100

to get 100ms latency on localhost
note: this will appear as 200 when running the client&server, because the 100ms is in each direction

to restore to normal, just
sudo set_latency 0


There are more commands available for shaping the delays with distributions, or introduction packet loss/corruption/reordering
