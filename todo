fix init / fix state sharing

begin to test messages
